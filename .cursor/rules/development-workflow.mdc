---
description:
globs:
alwaysApply: false
---
# Development Workflow Guide

## Quick Start

### Prerequisites
- **Node.js**: Version 18 or higher
- **npm**: Required package manager
- **Git**: Version control

### Initial Setup
```bash
# Clone repository
git clone <repository-url>
cd bracketbear

# Install dependencies
npm install

# Start all applications
npm run dev
```

## Development Commands

### Root Level Commands
```bash
# Start all applications concurrently
npm run dev

# Build all workspace packages
npm run build

# Lint all code
npm run lint

# Fix linting issues
npm run lint:fix

# Check linting with zero warnings
npm run lint:check
```

### Individual Application Commands

#### Bracket Bear Website
```bash
cd apps/bracketbear-website
npm run dev      # Start on port 4321
npm run build    # Build for production
npm run preview  # Preview production build
```

#### Portfolio
```bash
cd apps/portfolio
npm run dev      # Start on port 4322
npm run build    # Build for production
npm run preview  # Preview production build
```

#### CMS
```bash
cd apps/cms
npm run dev      # Start on port 3000
npm run build    # Build for production
npm start        # Start production server
```

#### Core Package
```bash
cd packages/core
npm run build    # Build all exports
npm run dev      # Watch mode for development
npm run clean    # Clean build artifacts
```

## Development URLs

- **Bracket Bear Website**: `http://localhost:4321`
- **Portfolio**: `http://localhost:4322`
- **CMS Admin**: `http://localhost:3000/keystatic`
- **CMS App**: `http://localhost:3000`

## Content Management Workflow

### 1. Start CMS
```bash
cd apps/cms
npm run dev
```

### 2. Access Admin Interface
Navigate to `http://localhost:3000/keystatic` in your browser.

### 3. Edit Content
Use the visual interface to:
- Add/edit companies, jobs, skills, projects
- Manage blog posts and pages
- Upload images and media
- Configure site settings

### 4. Content Sync
Changes are automatically available to both Astro applications.

## Code Organization

### Monorepo Structure
```
bracketbear/
├── apps/                    # Applications
│   ├── bracketbear-website/ # Company website (Astro)
│   ├── portfolio/           # Portfolio website (Astro)
│   └── cms/                # Content management (Next.js)
├── packages/                # Shared packages
│   ├── core/               # Design system & components
│   ├── astro-content/      # Shared content configuration
│   └── flateralus/         # Web animation library
├── package.json            # Root configuration
└── README.md              # Project overview
```

### Key Configuration Files
- [package.json](mdc:package.json) - Root workspace configuration
- [eslint.config.js](mdc:eslint.config.js) - Linting configuration
- [README.md](mdc:README.md) - Project documentation

## Common Development Tasks

### Adding New Content
1. Start CMS: `cd apps/cms && npm run dev`
2. Access admin: `http://localhost:3000/keystatic`
3. Add content through the interface
4. Content is automatically available in Astro apps

### Modifying Components
1. Edit components in `packages/core/src/`
2. Run `npm run dev` in `packages/core/` for watch mode
3. Changes are automatically reflected in consuming apps

### Adding New Pages
1. Create new `.astro` files in `apps/*/src/pages/`
2. Use the shared Layout component
3. Import content collections as needed

### Styling Changes
1. Modify styles in `packages/core/src/styles/`
2. Use Tailwind CSS with custom design tokens
3. Import shared styles in Astro apps

## Debugging

### Common Issues

#### Port Conflicts
If ports are already in use:
- Bracket Bear Website: Change port in `apps/bracketbear-website/package.json`
- Portfolio: Change port in `apps/portfolio/package.json`
- CMS: Change port in `apps/cms/package.json`

#### Content Not Updating
1. Ensure CMS is running: `cd apps/cms && npm run dev`
2. Check admin interface: `http://localhost:3000/keystatic`
3. Verify content files in `apps/cms/content/`

#### Build Errors
1. Clean builds: `npm run clean` (if available)
2. Reinstall dependencies: `rm -rf node_modules && npm install`
3. Check TypeScript errors: `npm run lint:check`

### Logs and Monitoring
- All application logs are combined when running `yarn dev`
- Individual app logs available when running apps separately
- Browser dev tools for frontend debugging

## Deployment

### Build Process
```bash
# Build all applications
npm run build

# Build outputs:
# - apps/bracketbear-website/dist/
# - apps/portfolio/dist/
# - apps/cms/.next/
```

### Deployment Options
- **Static Sites**: Deploy Astro apps to Vercel, Netlify, etc.
- **CMS**: Deploy Next.js app to Vercel, Railway, etc.
- **Content**: Store in repository or external storage

## Documentation Resources

- [Astro Documentation](https://docs.astro.build) - Astro framework
- [Next.js Documentation](https://nextjs.org/docs) - Next.js framework
- [Keystatic Documentation](https://keystatic.com/docs) - CMS system
- [Tailwind CSS Documentation](https://tailwindcss.com/docs) - Styling
- [TypeScript Documentation](https://www.typescriptlang.org/docs) - Type safety
- [npm Workspaces](https://docs.npmjs.com/cli/v7/using-npm/workspaces) - Monorepo management

## Overview
Follow these guidelines for efficient development and to avoid common issues encountered during the layered layout system implementation.

## Project Structure
- **Monorepo**: Root at [bracketbear/](mdc:bracketbear/)
- **Core Package**: [packages/core/](mdc:packages/core/)
- **Astro Apps**: [apps/](mdc:apps/)

## Development Commands
```bash
# Core package development
cd packages/core
npm run build

# Astro app development
cd apps/bracketbear-website
npm run dev
npm run build

# Portfolio app development
cd apps/portfolio
npm run dev
npm run build
```

## Common Issues & Solutions

### 1. Import/Export Issues
- **Problem**: Components not found when importing from `@bracketbear/core`
- **Solution**: Check exports in [packages/core/src/index.ts](mdc:packages/core/src/index.ts)
- **Prevention**: Always update exports when adding new components

### 2. PixiJS Coordinate Issues
- **Problem**: Effects not following mouse cursor correctly
- **Solution**: Use PixiJS events instead of window events
- **Prevention**: Follow [PixiJS Integration Guidelines](mdc:.cursor/rules/pixijs-integration.mdc)

### 3. Layer Z-Index Issues
- **Problem**: Elements not appearing in correct layers
- **Solution**: Use `LAYERS` constant, never manual z-index
- **Prevention**: Follow [Layered Layout System](mdc:.cursor/rules/layered-layout-system.mdc)

### 4. Build Failures
- **Problem**: TypeScript compilation errors
- **Solution**: Check type imports and exports
- **Prevention**: Test builds after any core package changes

## Development Process

### 1. Adding New Components
```bash
# 1. Add to core package
cd packages/core
# Create component in appropriate directory
# Update exports in index.ts

# 2. Test core package
npm run build

# 3. Update Astro apps
cd ../../apps/bracketbear-website
# Import and use new component
npm run build

cd ../portfolio
# Import and use new component
npm run build
```

### 2. Updating Existing Components
```bash
# 1. Update core package
cd packages/core
# Make changes to component
npm run build

# 2. Test in apps
cd ../../apps/bracketbear-website
npm run dev  # Test in development
npm run build  # Test build process
```

### 3. Debugging Process
1. **Check Console**: Look for JavaScript errors
2. **Check Build**: Ensure TypeScript compilation passes
3. **Check Imports**: Verify all imports are correct
4. **Check Exports**: Ensure components are properly exported
5. **Test Isolation**: Test component in isolation if possible

## File Management

### 1. Moving Components to Core
- **Source**: Remove from Astro app
- **Destination**: Add to core package
- **Update**: Update imports in all apps
- **Test**: Build all apps to verify

### 2. Renaming Components
- **Core Package**: Update component name and exports
- **Astro Apps**: Update all imports
- **Test**: Build all apps to verify

### 3. Removing Components
- **Core Package**: Remove component and exports
- **Astro Apps**: Remove all imports and usage
- **Test**: Build all apps to verify

## Best Practices

### 1. Type Safety
- Always use TypeScript interfaces
- Extend existing types when possible
- Use proper type imports/exports

### 2. Performance
- Use object pooling for frequently created objects
- Implement proper cleanup methods
- Limit particle counts and effect complexity

### 3. Code Organization
- Keep components modular and focused
- Use consistent naming conventions
- Document complex logic with comments

### 4. Testing
- Test builds after any changes
- Test in development mode
- Test pointer effects functionality
- Test layer positioning

## Troubleshooting Checklist
- [ ] Check TypeScript compilation
- [ ] Verify all imports are correct
- [ ] Test build process
- [ ] Check console for errors
- [ ] Verify pointer effects work
- [ ] Test layer positioning
- [ ] Check memory usage
- [ ] Test in different browsers
