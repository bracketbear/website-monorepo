---
import clsx from 'clsx';
import LayeredLayout, {
  type Props as LayeredLayoutProps,
} from './LayeredLayout.astro';

interface Props extends LayeredLayoutProps {
  /** The title to display in the hero section and page title */
  title: string;
  /** Whether to show the hero section at the top of the page */
  showHero?: boolean;
  /** The maximum width of the content area */
  contentWidth?: 'narrow' | 'wide';
}

const { title, showHero = true, contentWidth = 'wide', ...rest } = Astro.props;

const maxWidthClass = contentWidth === 'narrow' ? 'max-w-6xl' : '';
---

<LayeredLayout title={title} {...rest}>
  {
    showHero && (
      <div class="bg-muted pb-8">
        <div
          class={clsx('container mx-auto py-12', {
            'max-w-6xl': contentWidth === 'narrow',
          })}
        >
          <div class="flex flex-col gap-8 md:flex-row md:items-end md:justify-between">
            <div class="flex-1">
              <div class="mb-4 flex items-center gap-4">
                <slot name="title-pills" />
              </div>

              <h1 class="font-heading text-primary mb-2 text-4xl leading-none uppercase md:text-6xl">
                {title}
              </h1>

              <div class="mt-8 flex items-start gap-12 md:flex-row">
                <slot name="detail-blocks" />
              </div>
            </div>

            <div class="flex flex-shrink-0 flex-col items-end gap-2">
              <slot name="cover-image">
                <div class="border-primary bg-muted flex h-48 w-48 items-center justify-center border-2">
                  <span class="text-primary font-mono text-xs opacity-60">
                    [Cover Image]
                  </span>
                </div>
              </slot>
            </div>
          </div>

          <slot name="summary" />
          <div class="pointer-events-none bottom-0 left-0 flex w-full justify-center select-none">
            <div
              class="h-4 w-2/3 bg-repeat-x"
              style="background-image: url('/patterns/halftone.svg'); opacity: 0.12;"
            />
          </div>
        </div>
      </div>
    )
  }

  <div class="bg-background/50 min-h-screen py-24">
    <div class={`container mx-auto ${maxWidthClass}`}>
      <slot />
    </div>
  </div>
</LayeredLayout>
