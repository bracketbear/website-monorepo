---
import clsx from 'clsx';
import LayeredLayout, {
  type Props as LayeredLayoutProps,
} from './LayeredLayout.astro';
import { HeroBackgroundWrapper } from '../components';

interface Props extends LayeredLayoutProps {
  /** The title to display in the hero section and page title */
  title: string;
  /** Whether to show the hero section at the top of the page */
  showHero?: boolean;
  /** The maximum width of the content area */
  contentWidth?: 'narrow' | 'wide';
}

const { title, showHero = true, contentWidth = 'wide', ...rest } = Astro.props;

const maxWidthClass = contentWidth === 'narrow' ? 'max-w-6xl' : '';
---

<LayeredLayout title={title} hideNavigation={true} {...rest}>
  <!-- Transparent Navigation -->
  <div class="relative z-50">
    <slot name="navigation" />
  </div>

  {showHero && (
    <section class="relative h-[60vh] w-full">
      <!-- Animation Background with Content -->
      <slot name="hero-background">
        <!-- Default particle wave background -->
        <HeroBackgroundWrapper>
          <!-- Hero Content as child of AnimationStage -->
          <div class="relative z-10 flex h-full items-center justify-center">
            <div class={clsx('container mx-auto px-6', {
              'max-w-6xl': contentWidth === 'narrow',
            })}>
              <div class="mx-auto max-w-4xl text-center">
                <!-- Title Pills -->
                <div class="mb-6 flex items-center justify-center gap-4">
                  <slot name="title-pills" />
                </div>
                
                <!-- Main Title -->
                <h1
                  class="font-heading text-white mb-6 text-5xl leading-none uppercase drop-shadow-lg md:text-7xl lg:text-8xl"
                >
                  {title}
                </h1>
                
                <!-- Detail Blocks -->
                <div class="mt-8 flex flex-col items-center gap-8 md:flex-row md:justify-center">
                  <slot name="detail-blocks" />
                </div>
                
                <!-- Cover Image/Art -->
                <div class="mt-12 flex justify-center">
                  <slot name="cover-image">
                    <!-- Default placeholder -->
                    <div
                      class="border-white flex h-32 w-32 items-center justify-center border-2 bg-white/10 backdrop-blur-sm md:h-48 md:w-48"
                    >
                      <span class="text-white font-mono text-xs opacity-60"
                        >[Cover Image]</span
                      >
                    </div>
                  </slot>
                </div>
              </div>
              
              <!-- Summary Block -->
              <div class="mt-12">
                <slot name="summary" />
              </div>
            </div>
          </div>
        </HeroBackgroundWrapper>
      </slot>
    </section>
  )}
  
  <!-- Main Content -->
  <div class="bg-primary/50 min-h-screen py-24">
    <div class={`container mx-auto ${maxWidthClass} px-6`}>
      <slot />
    </div>
  </div>
</LayeredLayout>
