@utility font-heading {
  --heading-font-family: 'Oswald', 'sans-serif';
  font-family: var(--heading-font-family);
}

@utility heading {
  @apply font-heading font-bold tracking-tighter;
}

/* A useful utility for limiting the width of prose text. */
@utility max-w-prose {
  @apply max-w-[65ch];

  @variant xl {
    @apply max-w-[75ch];
  }
}

@utility typography {
  & h1 {
    @apply text-4xl font-bold tracking-tight sm:text-5xl lg:text-6xl;
  }

  & h2 {
    @apply text-3xl font-bold tracking-tight sm:text-4xl lg:text-5xl;
  }

  & h3 {
    @apply text-2xl font-bold tracking-tight sm:text-3xl lg:text-4xl;
  }

  & h4 {
    @apply text-xl font-bold tracking-tight sm:text-2xl lg:text-3xl;
  }

  & p {
    @apply text-lg leading-relaxed font-medium;
  }
}

/* Base prose utility - replicates Tailwind's typography plugin */
@utility prose {
  @apply text-brand-dark;

  /* Base prose variables - these will be overridden by size variants */
  --prose-font-size: 1rem;
  --prose-line-height: 1.75;
  --prose-spacing: 1.25em;
  --prose-heading-spacing: 0.5em;
  --prose-list-spacing: 1.625em;
  --prose-blockquote-spacing: 1em;
  --prose-pre-spacing: 0.8571429em;
  --prose-table-spacing: 0.5714286em;
  --prose-hr-spacing: 3em;

  /* Heading size multipliers */
  --prose-h1-size: 2.25em;
  --prose-h2-size: 1.5em;
  --prose-h3-size: 1.25em;
  --prose-h4-size: 1em;

  & h1 {
    @apply mt-0 mb-[0.8888889em] font-extrabold;
    font-size: var(--prose-h1-size);
    line-height: 1.1111111;
  }

  & h2 {
    @apply mt-8 mb-4 font-bold;
    font-size: var(--prose-h2-size);
    line-height: 1.3333333;
  }

  & h3 {
    @apply mt-6 mb-2 font-semibold;
    font-size: var(--prose-h3-size);
    line-height: 1.6;
  }

  & h4 {
    @apply mt-6 mb-2 font-semibold;
    font-size: var(--prose-h4-size);
    line-height: 1.5;
  }

  & p {
    margin-top: var(--prose-spacing);
    margin-bottom: var(--prose-spacing);
    line-height: var(--prose-line-height);
  }

  & ul,
  & ol {
    margin-top: var(--prose-spacing);
    margin-bottom: var(--prose-spacing);
    padding-left: var(--prose-list-spacing);
  }

  & li {
    margin-top: calc(var(--prose-spacing) * 0.25);
    margin-bottom: calc(var(--prose-spacing) * 0.25);
  }

  & ul > li {
    @apply relative;
    padding-left: 1.375em;
  }

  & ul > li::before {
    content: '';
    @apply absolute top-[0.6875em] left-[0.25em] h-[0.375em] w-[0.375em] rounded-full bg-current;
  }

  & ol > li {
    @apply relative;
    padding-left: 1.375em;
  }

  & ol > li::before {
    content: counter(list-item, decimal) '.';
    @apply absolute top-0 left-0 w-[1.625em] font-normal text-current;
  }

  & blockquote {
    @apply border-l-4 border-l-current font-medium italic;
    margin-top: calc(var(--prose-spacing) * 1.2);
    margin-bottom: calc(var(--prose-spacing) * 1.2);
    padding-left: var(--prose-blockquote-spacing);
    quotes: '\201C' '\201D' '\2018' '\2019';
  }

  & blockquote p:first-of-type::before {
    content: open-quote;
  }

  & blockquote p:last-of-type::after {
    content: close-quote;
  }

  & code {
    @apply text-sm font-semibold;
  }

  & code::before {
    content: '`';
  }

  & code::after {
    content: '`';
  }

  & pre {
    @apply overflow-x-auto rounded-md border border-current bg-transparent text-sm font-normal;
    margin-top: var(--prose-spacing);
    margin-bottom: var(--prose-spacing);
    padding: var(--prose-pre-spacing) 1em;
    line-height: 1.7142857;
  }

  & pre code {
    @apply rounded-none border-0 bg-transparent p-0;
  }

  & pre code::before {
    content: none;
  }

  & pre code::after {
    content: none;
  }

  & table {
    @apply w-full table-auto text-left text-sm;
    margin-top: var(--prose-spacing);
    margin-bottom: var(--prose-spacing);
    line-height: 1.7142857;
  }

  & thead {
    @apply border-b border-current font-semibold;
  }

  & thead th {
    @apply align-bottom;
    padding: var(--prose-table-spacing) 0.5714286em;
  }

  & tbody tr {
    @apply border-b border-current;
  }

  & tbody tr:last-child {
    @apply border-b-0;
  }

  & tbody td {
    @apply align-baseline;
    padding: var(--prose-table-spacing) 0.5714286em;
  }

  & a {
    @apply font-medium underline;
  }

  & img {
    margin-top: var(--prose-spacing);
    margin-bottom: var(--prose-spacing);
  }

  & hr {
    @apply border-t border-current;
    margin-top: var(--prose-hr-spacing);
    margin-bottom: var(--prose-hr-spacing);
  }

  & strong {
    @apply font-semibold;
  }

  & em {
    @apply italic;
  }

  & small {
    @apply text-sm;
  }

  & abbr {
    @apply underline decoration-dotted;
  }

  & mark {
    @apply bg-current;
  }
}

/* Prose size variants - apply the prose utility and override variables */
@utility prose-sm {
  @apply prose;

  --prose-font-size: 0.875rem;
  --prose-line-height: 1.7142857;
  --prose-spacing: 1.1428571em;
  --prose-heading-spacing: 0.5714286em;
  --prose-list-spacing: 1.5714286em;
  --prose-blockquote-spacing: 1.1111111em;
  --prose-pre-spacing: 0.75em;
  --prose-table-spacing: 0.5714286em;
  --prose-hr-spacing: 2.2857143em;
  --prose-h1-size: 1.4285714em;
  --prose-h2-size: 1.2857143em;
  --prose-h3-size: 1.1428571em;
  --prose-h4-size: 1em;

  @apply text-sm;
}

@utility prose-lg {
  @apply prose;

  --prose-font-size: 1.125rem;
  --prose-line-height: 1.7777778;
  --prose-spacing: 1.3333333em;
  --prose-heading-spacing: 0.6666667em;
  --prose-list-spacing: 1.5555556em;
  --prose-blockquote-spacing: 1em;
  --prose-pre-spacing: 0.8888889em;
  --prose-table-spacing: 0.5714286em;
  --prose-hr-spacing: 2.6666667em;
  --prose-h1-size: 2.6666667em;
  --prose-h2-size: 1.6666667em;
  --prose-h3-size: 1.3333333em;
  --prose-h4-size: 1.1111111em;

  @apply text-lg;
}

@utility prose-xl {
  @apply prose;

  --prose-font-size: 1.25rem;
  --prose-line-height: 1.75;
  --prose-spacing: 1.375em;
  --prose-heading-spacing: 0.6875em;
  --prose-list-spacing: 1.5em;
  --prose-blockquote-spacing: 1em;
  --prose-pre-spacing: 0.75em;
  --prose-table-spacing: 0.5714286em;
  --prose-hr-spacing: 2.75em;
  --prose-h1-size: 3em;
  --prose-h2-size: 1.875em;
  --prose-h3-size: 1.5em;
  --prose-h4-size: 1.25em;

  @apply text-xl;
}

@utility prose-2xl {
  @apply prose;

  --prose-font-size: 1.5rem;
  --prose-line-height: 1.6666667;
  --prose-spacing: 1.4166667em;
  --prose-heading-spacing: 0.7083333em;
  --prose-list-spacing: 1.4583333em;
  --prose-blockquote-spacing: 1em;
  --prose-pre-spacing: 0.6666667em;
  --prose-table-spacing: 0.5714286em;
  --prose-hr-spacing: 2.8333333em;
  --prose-h1-size: 3.3333333em;
  --prose-h2-size: 2.0833333em;
  --prose-h3-size: 1.6666667em;
  --prose-h4-size: 1.3333333em;

  @apply text-2xl;
}

/* Prose color modifiers */
@layer components {
  .prose-headings\:text-white h1,
  .prose-headings\:text-white h2,
  .prose-headings\:text-white h3,
  .prose-headings\:text-white h4 {
    @apply text-white;
  }

  .prose-p\:text-white\/90 p {
    @apply text-white/90;
  }

  .prose-p\:text-white\/80 p {
    @apply text-white/80;
  }

  .prose-headings\:text-brand-dark h1,
  .prose-headings\:text-brand-dark h2,
  .prose-headings\:text-brand-dark h3,
  .prose-headings\:text-brand-dark h4 {
    @apply text-brand-dark;
  }

  .prose-p\:text-brand-dark\/90 p {
    @apply text-brand-dark/90;
  }

  .prose-p\:text-brand-dark\/80 p {
    @apply text-brand-dark/80;
  }
}
