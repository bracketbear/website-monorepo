---
/**
 * HeroLayout - Local hero layout with AnimationStage background and transparent nav
 *
 * This layout provides a hero section with AnimationStage for particle backgrounds
 * and transparent navigation overlay, similar to the homepage.
 *
 * Usage:
 * <HeroLayout
 *   pageTitle="My Projects"
 *   hero={page.hero}
 *   breadcrumbs={breadcrumbs}
 * >
 *   <!-- Page content here -->
 * </HeroLayout>
 */
import Layout from './Layout.astro';
import { clsx, NavBar, type ObjectValues } from '@bracketbear/core';
import { navigationConfig } from '@/config/navigation';
import { generatePortfolioMetaTitle } from '@/config/meta-title';
import HeaderSection from '@/components/HeaderSection';
import type { ControlValues } from '@bracketbear/flateralus';

const presets = {
  'curious-particle-network': 'curious-particle-network',
  'particle-wave': 'particle-wave',
  'topographic-lines': 'topographic-lines',
} as const;
type Preset = ObjectValues<typeof presets>;

export interface Props {
  pageTitle?: string;
  title?: string;
  subtitle?: string;
  description?: string;
  ctaText?: string;
  ctaHref?: string;
  stats?: any[];
  hideContactForm?: boolean;
  hideFooter?: boolean;
  hideNavigation?: boolean;
  breadcrumbs?: any;
  hero?: any;
  animationPreset?: Preset;
  animationControls?: ControlValues;
  container?: boolean;
  contactCTA?: {
    text: string;
    buttonText: string;
    buttonLink: string;
  };
}

const {
  pageTitle,
  animationPreset = 'curious-particle-network' as const,
  container = true,
  contactCTA,
  ...props
} = Astro.props;

// Generate meta title from page title
const metaTitle = pageTitle ? generatePortfolioMetaTitle(pageTitle) : undefined;
---

<Layout {...props} hideNavigation={true} title={metaTitle}>
  <!-- Transparent Navigation -->
  <div class="relative z-50">
    <NavBar config={navigationConfig} variant="ghost-dark" />
  </div>

  <!-- Header Section with Flateralus Animation -->
  {
    props.title && (
      <HeaderSection
        preset={presets[animationPreset]}
        className="bg-[#5c7c4f] from-brand-red/20 to-[#5c7c4f] bg-radial"
        showDebugControls={true}
        enableLuminanceDetection={true}
        title={props.title}
        subtitle={props.subtitle}
        description={props.description}
        ctaText={props.ctaText}
        ctaHref={props.ctaHref}
        stats={props.stats}
        client:load
      />
    )
  }

  <!-- Page Content -->
  <div class="bg-brand-dark relative py-24">
    <div class={clsx(container && 'container mx-auto')}>
      <slot />
    </div>
  </div>

  <!-- Contact CTA Section -->
  {
    contactCTA && (
      <div class="bg-brand-dark py-24">
        <div class="container mx-auto px-6">
          <div class="mx-auto max-w-4xl text-center">
            <p class="mb-8 text-xl leading-relaxed font-medium text-white/90">
              {contactCTA.text}
            </p>
            <a
              href={contactCTA.buttonLink}
              class="button button-primary button-lg"
            >
              {contactCTA.buttonText}
            </a>
          </div>
        </div>
      </div>
    )
  }
</Layout>
